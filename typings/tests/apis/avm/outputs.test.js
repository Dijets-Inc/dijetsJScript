"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const bn_js_1 = __importDefault(require("bn.js"));
const bintools_1 = __importDefault(require("src/utils/bintools"));
const outputs_1 = require("src/apis/avm/outputs");
const output_1 = require("src/common/output");
const outputs_2 = require("../../../src/apis/avm/outputs");
const avm_1 = require("src/apis/avm");
const bintools = bintools_1.default.getInstance();
describe('Outputs', () => {
    const codecID_zero = 0;
    const codecID_one = 1;
    describe('NFTMintOutput', () => {
        let addrs = [
            bintools.cb58Decode("B6D4v1VtPYLbiUvYXtW4Px8oE9imC2vGW"),
            bintools.cb58Decode("P5wdRuZeaDt28eHMP5S3w9ZdoBfo7wuzF"),
            bintools.cb58Decode("6Y3kysjF9jnHnYkdS9yGAuoHyae2eNmeV")
        ].sort();
        let locktime = new bn_js_1.default(54321);
        let addrpay = [addrs[0], addrs[1]];
        let fallLocktime = locktime.add(new bn_js_1.default(50));
        test('SelectOutputClass', () => {
            let goodout = new outputs_1.NFTMintOutput(0, addrpay, fallLocktime, 1);
            let outpayment = outputs_1.SelectOutputClass(goodout.getOutputID());
            expect(outpayment).toBeInstanceOf(outputs_1.NFTMintOutput);
            expect(() => {
                outputs_1.SelectOutputClass(99);
            }).toThrow("Error - SelectOutputClass: unknown outputid");
        });
        test('comparator', () => {
            let outpayment1 = new outputs_1.NFTMintOutput(1, addrs, fallLocktime, 1);
            let outpayment2 = new outputs_1.NFTMintOutput(2, addrs, fallLocktime, 1);
            let outpayment3 = new outputs_1.NFTMintOutput(0, addrs, fallLocktime, 1);
            let cmp = output_1.Output.comparator();
            expect(cmp(outpayment1, outpayment1)).toBe(0);
            expect(cmp(outpayment2, outpayment2)).toBe(0);
            expect(cmp(outpayment3, outpayment3)).toBe(0);
            expect(cmp(outpayment1, outpayment2)).toBe(-1);
            expect(cmp(outpayment1, outpayment3)).toBe(1);
        });
        test("NFTMintOutput codecIDs", () => {
            const nftMintOutput = new outputs_1.NFTMintOutput(1, addrs, fallLocktime, 1);
            expect(nftMintOutput.getCodecID()).toBe(codecID_zero);
            expect(nftMintOutput.getOutputID()).toBe(avm_1.AVMConstants.NFTMINTOUTPUTID);
            nftMintOutput.setCodecID(codecID_one);
            expect(nftMintOutput.getCodecID()).toBe(codecID_one);
            expect(nftMintOutput.getOutputID()).toBe(avm_1.AVMConstants.NFTMINTOUTPUTID_CODECONE);
            nftMintOutput.setCodecID(codecID_zero);
            expect(nftMintOutput.getCodecID()).toBe(codecID_zero);
            expect(nftMintOutput.getOutputID()).toBe(avm_1.AVMConstants.NFTMINTOUTPUTID);
        });
        test("Invalid NFTMintOutput codecID", () => {
            const nftMintOutput = new outputs_1.NFTMintOutput(1, addrs, fallLocktime, 1);
            expect(() => {
                nftMintOutput.setCodecID(2);
            }).toThrow("Error - NFTMintOutput.setCodecID: invalid codecID. Valid codecIDs are 0 and 1.");
        });
        test('Functionality', () => {
            let out = new outputs_1.NFTMintOutput(0, addrs, fallLocktime, 3);
            expect(out.getOutputID()).toBe(10);
            expect(JSON.stringify(out.getAddresses().sort())).toStrictEqual(JSON.stringify(addrs.sort()));
            expect(out.getThreshold()).toBe(3);
            // expect(out.getLocktime().toNumber()).toBe(locktime.toNumber());
            let r = out.getAddressIdx(addrs[2]);
            expect(out.getAddress(r)).toStrictEqual(addrs[2]);
            expect(() => {
                out.getAddress(400);
            }).toThrow();
            let b = out.toBuffer();
            expect(out.toString()).toBe(bintools.bufferToB58(b));
            let s = out.getSpenders(addrs);
            expect(JSON.stringify(s.sort())).toBe(JSON.stringify(addrs.sort()));
            let m1 = out.meetsThreshold([addrs[0]]);
            expect(m1).toBe(false);
            let m2 = out.meetsThreshold(addrs, new bn_js_1.default(100));
            expect(m2).toBe(false);
            let m3 = out.meetsThreshold(addrs);
            expect(m3).toBe(true);
            let m4 = out.meetsThreshold(addrs, locktime.add(new bn_js_1.default(100)));
            expect(m4).toBe(true);
        });
    });
    describe('SECPTransferOutput', () => {
        let addrs = [
            bintools.cb58Decode("B6D4v1VtPYLbiUvYXtW4Px8oE9imC2vGW"),
            bintools.cb58Decode("P5wdRuZeaDt28eHMP5S3w9ZdoBfo7wuzF"),
            bintools.cb58Decode("6Y3kysjF9jnHnYkdS9yGAuoHyae2eNmeV")
        ].sort();
        let locktime = new bn_js_1.default(54321);
        let addrpay = [addrs[0], addrs[1]];
        let fallLocktime = locktime.add(new bn_js_1.default(50));
        test('SelectOutputClass', () => {
            let goodout = new outputs_1.SECPTransferOutput(new bn_js_1.default(2600), addrpay, fallLocktime, 1);
            let outpayment = outputs_1.SelectOutputClass(goodout.getOutputID());
            expect(outpayment).toBeInstanceOf(outputs_1.SECPTransferOutput);
            expect(() => {
                outputs_1.SelectOutputClass(99);
            }).toThrow("Error - SelectOutputClass: unknown outputid");
        });
        test('comparator', () => {
            let outpayment1 = new outputs_1.SECPTransferOutput(new bn_js_1.default(10000), addrs, locktime, 3);
            let outpayment2 = new outputs_1.SECPTransferOutput(new bn_js_1.default(10001), addrs, locktime, 3);
            let outpayment3 = new outputs_1.SECPTransferOutput(new bn_js_1.default(9999), addrs, locktime, 3);
            let cmp = output_1.Output.comparator();
            expect(cmp(outpayment1, outpayment1)).toBe(0);
            expect(cmp(outpayment2, outpayment2)).toBe(0);
            expect(cmp(outpayment3, outpayment3)).toBe(0);
            expect(cmp(outpayment1, outpayment2)).toBe(-1);
            expect(cmp(outpayment1, outpayment3)).toBe(1);
        });
        test('SECPTransferOutput', () => {
            let out = new outputs_1.SECPTransferOutput(new bn_js_1.default(10000), addrs, locktime, 3);
            expect(out.getOutputID()).toBe(7);
            expect(JSON.stringify(out.getAddresses().sort())).toStrictEqual(JSON.stringify(addrs.sort()));
            expect(out.getThreshold()).toBe(3);
            expect(out.getLocktime().toNumber()).toBe(locktime.toNumber());
            let r = out.getAddressIdx(addrs[2]);
            expect(out.getAddress(r)).toStrictEqual(addrs[2]);
            expect(() => {
                out.getAddress(400);
            }).toThrow();
            expect(out.getAmount().toNumber()).toBe(10000);
            let b = out.toBuffer();
            expect(out.toString()).toBe(bintools.bufferToB58(b));
            let s = out.getSpenders(addrs);
            expect(JSON.stringify(s.sort())).toBe(JSON.stringify(addrs.sort()));
            let m1 = out.meetsThreshold([addrs[0]]);
            expect(m1).toBe(false);
            let m2 = out.meetsThreshold(addrs, new bn_js_1.default(100));
            expect(m2).toBe(false);
            let m3 = out.meetsThreshold(addrs);
            expect(m3).toBe(true);
            let m4 = out.meetsThreshold(addrs, locktime.add(new bn_js_1.default(100)));
            expect(m4).toBe(true);
        });
        test("SECPTransferOutput codecIDs", () => {
            const secPTransferOutput = new outputs_1.SECPTransferOutput(new bn_js_1.default(10000), addrs, locktime, 3);
            expect(secPTransferOutput.getCodecID()).toBe(codecID_zero);
            expect(secPTransferOutput.getOutputID()).toBe(avm_1.AVMConstants.SECPXFEROUTPUTID);
            secPTransferOutput.setCodecID(codecID_one);
            expect(secPTransferOutput.getCodecID()).toBe(codecID_one);
            expect(secPTransferOutput.getOutputID()).toBe(avm_1.AVMConstants.SECPXFEROUTPUTID_CODECONE);
            secPTransferOutput.setCodecID(codecID_zero);
            expect(secPTransferOutput.getCodecID()).toBe(codecID_zero);
            expect(secPTransferOutput.getOutputID()).toBe(avm_1.AVMConstants.SECPXFEROUTPUTID);
        });
        test("Invalid SECPTransferOutput codecID", () => {
            const secPTransferOutput = new outputs_1.SECPTransferOutput(new bn_js_1.default(10000), addrs, locktime, 3);
            expect(() => {
                secPTransferOutput.setCodecID(2);
            }).toThrow("Error - SECPTransferOutput.setCodecID: invalid codecID. Valid codecIDs are 0 and 1.");
        });
        test('SECPMintOutput', () => {
            let out = new outputs_2.SECPMintOutput(addrs, locktime, 3);
            expect(out.getOutputID()).toBe(6);
            expect(JSON.stringify(out.getAddresses().sort())).toStrictEqual(JSON.stringify(addrs.sort()));
            expect(out.getThreshold()).toBe(3);
            expect(out.getLocktime().toNumber()).toBe(locktime.toNumber());
            let r = out.getAddressIdx(addrs[2]);
            expect(out.getAddress(r)).toStrictEqual(addrs[2]);
            expect(() => {
                out.getAddress(400);
            }).toThrow();
            let b = out.toBuffer();
            expect(out.toString()).toBe(bintools.bufferToB58(b));
            let s = out.getSpenders(addrs);
            expect(JSON.stringify(s.sort())).toBe(JSON.stringify(addrs.sort()));
            let m1 = out.meetsThreshold([addrs[0]]);
            expect(m1).toBe(false);
            let m2 = out.meetsThreshold(addrs, new bn_js_1.default(100));
            expect(m2).toBe(false);
            let m3 = out.meetsThreshold(addrs);
            expect(m3).toBe(true);
            let m4 = out.meetsThreshold(addrs, locktime.add(new bn_js_1.default(100)));
            expect(m4).toBe(true);
        });
        test("SECPMintOutput codecIDs", () => {
            let secpMintOutput = new outputs_2.SECPMintOutput(addrs, locktime, 3);
            expect(secpMintOutput.getCodecID()).toBe(codecID_zero);
            expect(secpMintOutput.getOutputID()).toBe(avm_1.AVMConstants.SECPMINTOUTPUTID);
            secpMintOutput.setCodecID(codecID_one);
            expect(secpMintOutput.getCodecID()).toBe(codecID_one);
            expect(secpMintOutput.getOutputID()).toBe(avm_1.AVMConstants.SECPMINTOUTPUTID_CODECONE);
            secpMintOutput.setCodecID(codecID_zero);
            expect(secpMintOutput.getCodecID()).toBe(codecID_zero);
            expect(secpMintOutput.getOutputID()).toBe(avm_1.AVMConstants.SECPMINTOUTPUTID);
        });
        test("Invalid SECPMintOutput codecID", () => {
            const secpMintOutput = new outputs_2.SECPMintOutput(addrs, locktime, 3);
            expect(() => {
                secpMintOutput.setCodecID(2);
            }).toThrow("Error - SECPMintOutput.setCodecID: invalid codecID. Valid codecIDs are 0 and 1.");
        });
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib3V0cHV0cy50ZXN0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vdGVzdHMvYXBpcy9hdm0vb3V0cHV0cy50ZXN0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsa0RBQXVCO0FBRXZCLGtFQUEwQztBQUMxQyxrREFBNEY7QUFDNUYsOENBQTJDO0FBQzNDLDJEQUErRDtBQUMvRCxzQ0FBNEM7QUFFNUMsTUFBTSxRQUFRLEdBQUcsa0JBQVEsQ0FBQyxXQUFXLEVBQUUsQ0FBQztBQUV4QyxRQUFRLENBQUMsU0FBUyxFQUFFLEdBQUcsRUFBRTtJQUNyQixNQUFNLFlBQVksR0FBVyxDQUFDLENBQUM7SUFDL0IsTUFBTSxXQUFXLEdBQVcsQ0FBQyxDQUFDO0lBQzlCLFFBQVEsQ0FBQyxlQUFlLEVBQUUsR0FBRyxFQUFFO1FBQzdCLElBQUksS0FBSyxHQUFpQjtZQUN0QixRQUFRLENBQUMsVUFBVSxDQUFDLG1DQUFtQyxDQUFDO1lBQ3hELFFBQVEsQ0FBQyxVQUFVLENBQUMsbUNBQW1DLENBQUM7WUFDeEQsUUFBUSxDQUFDLFVBQVUsQ0FBQyxtQ0FBbUMsQ0FBQztTQUMzRCxDQUFDLElBQUksRUFBRSxDQUFDO1FBRVQsSUFBSSxRQUFRLEdBQU0sSUFBSSxlQUFFLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDaEMsSUFBSSxPQUFPLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUUsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDbkMsSUFBSSxZQUFZLEdBQU0sUUFBUSxDQUFDLEdBQUcsQ0FBQyxJQUFJLGVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBRS9DLElBQUksQ0FBQyxtQkFBbUIsRUFBRSxHQUFHLEVBQUU7WUFDM0IsSUFBSSxPQUFPLEdBQWlCLElBQUksdUJBQWEsQ0FBQyxDQUFDLEVBQUUsT0FBTyxFQUFFLFlBQVksRUFBRSxDQUFDLENBQUMsQ0FBQztZQUMzRSxJQUFJLFVB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LElBQUksV0FBVyxHQUFVLElBQUksNEJBQWtCLENBQUMsSUFBSSxlQUFFLENBQUMsS0FBSyxDQUFDLEVBQUUsS0FBSyxFQUFFLFFBQVEsRUFBRSxDQUFDLENBQUMsQ0FBQztZQUNuRixJQUFJLFdBQVcsR0FBVSxJQUFJLDRCQUFrQixDQUFDLElBQUksZUFBRSxDQUFDLElBQUksQ0FBQyxFQUFFLEtBQUssRUFBRSxRQUFRLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDbEYsSUFBSSxHQUFHLEdBQUcsZUFBTSxDQUFDLFVBQVUsRUFBRSxDQUFDO1lBQzlCLE1BQU0sQ0FBQyxHQUFHLENBQUMsV0FBVyxFQUFFLFdBQVcsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQzlDLE1BQU0sQ0FBQyxHQUFHLENBQUMsV0FBVyxFQUFFLFdBQVcsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQzlDLE1BQU0sQ0FBQyxHQUFHLENBQUMsV0FBVyxFQUFFLFdBQVcsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQzlDLE1BQU0sQ0FBQyxHQUFHLENBQUMsV0FBVyxFQUFFLFdBQVcsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDL0MsTUFBTSxDQUFDLEdBQUcsQ0FBQyxXQUFXLEVBQUUsV0FBVyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDbEQsQ0FBQyxDQUFDLENBQUM7UUFFSCxJQUFJLENBQUMsb0JBQW9CLEVBQUUsR0FBRyxFQUFFO1lBQzVCLElBQUksR0FBRyxHQUFzQixJQUFJLDRCQUFrQixDQUFDLElBQUksZUFBRSxDQUFDLEtBQUssQ0FBQyxFQUFFLEtBQUssRUFBRSxRQUFRLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDdkYsTUFBTSxDQUFDLEdBQUcsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNsQyxNQUFN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QUFDLElBQUksQ0FBQyxrQkFBWSxDQUFDLGdCQUFnQixDQUFDLENBQUM7WUFDekUsY0FBYyxDQUFDLFVBQVUsQ0FBQyxXQUFXLENBQUMsQ0FBQTtZQUN0QyxNQUFNLENBQUMsY0FBYyxDQUFDLFVBQVUsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBQ3RELE1BQU0sQ0FBQyxjQUFjLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsa0JBQVksQ0FBQyx5QkFBeUIsQ0FBQyxDQUFDO1lBQ2xGLGNBQWMsQ0FBQyxVQUFVLENBQUMsWUFBWSxDQUFDLENBQUE7WUFDdkMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxVQUFVLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQztZQUN2RCxNQUFNLENBQUMsY0FBYyxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLGtCQUFZLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztRQUMzRSxDQUFDLENBQUMsQ0FBQztRQUVILElBQUksQ0FBQyxnQ0FBZ0MsRUFBRSxHQUFTLEVBQUU7WUFDOUMsTUFBTSxjQUFjLEdBQW1CLElBQUksd0JBQWMsQ0FBQyxLQUFLLEVBQUUsUUFBUSxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBQzlFLE1BQU0sQ0FBQyxHQUFHLEVBQUU7Z0JBQ1YsY0FBYyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQTtZQUM5QixDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsaUZBQWlGLENBQUMsQ0FBQztRQUNsRyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ1AsQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQk4gZnJvbSAnYm4uanMnO1xuaW1wb3J0IHsgQnVmZmVyIH0gZnJvbSAnYnVmZmVyLyc7XG5pbXBvcnQgQmluVG9vbHMgZnJvbSAnc3JjL3V0aWxzL2JpbnRvb2xzJztcbmltcG9ydCB7IFNFQ1BUcmFuc2Zlck91dHB1dCwgU2VsZWN0T3V0cHV0Q2xhc3MsIE5GVE1pbnRPdXRwdXQgfSBmcm9tICdzcmMvYXBpcy9hdm0vb3V0cHV0cyc7XG5pbXBvcnQgeyBPdXRwdXQgfSBmcm9tICdzcmMvY29tbW9uL291dHB1dCc7XG5pbXBvcnQgeyBTRUNQTWludE91dHB1dCB9IGZyb20gJy4uLy4uLy4uL3NyYy9hcGlzL2F2bS9vdXRwdXRzJztcbmltcG9ydCB7IEFWTUNvbnN0YW50cyB9IGZyb20gJ3NyYy9hcGlzL2F2bSc7XG5cbmNvbnN0IGJpbnRvb2xzID0gQmluVG9vbHMuZ2V0SW5zdGFuY2UoKTtcblxuZGVzY3JpYmUoJ091dHB1dHMnLCAoKSA9PiB7XG4gICAgY29uc3QgY29kZWNJRF96ZXJvOiBudW1iZXIgPSAwO1xuICAgIGNvbnN0IGNvZGVjSURfb25lOiBudW1iZXIgPSAxO1xuICAgIGRlc2NyaWJlKCdORlRNaW50T3V0cHV0JywgKCkgPT4ge1xuICAgICAgbGV0IGFkZHJzOkFycmF5PEJ1ZmZlcj4gPSBbXG4gICAgICAgICAgYmludG9vbHMuY2I1OERlY29kZShcIkI2RDR2MVZ0UFlMYmlVdllYdFc0UHg4b0U5aW1DMnZHV1wiKSxcbiAgICAgICAgICBiaW50b29scy5jYjU4RGVjb2RlKFwiUDV3ZFJ1WmVhRHQyOGVITVA1UzN3OVpkb0Jmbzd3dXpGXCIpLFxuICAgICAgICAgIGJpbnRvb2xzLmNiNThEZWNvZGUoXCI2WTNreXNqRjlqbkhuWWtkUzl5R0F1b0h5YWUyZU5tZVZcIilcbiAgICAgIF0uc29ydCgpO1xuXG4gICAgICBsZXQgbG9ja3RpbWU6Qk4gPSBuZXcgQk4oNTQzMjEpO1xuICAgICAgbGV0IGFkZHJwYXkgPSBbYWRkcnNbMF0sIGFkZHJzWzFdXTtcbiAgICAgIGxldCBmYWxsTG9ja3RpbWU6Qk4gPSBsb2NrdGltZS5hZGQobmV3IEJOKDUwKSk7XG5cbiAgICAgIHRlc3QoJ1NlbGVjdE91dHB1dENsYXNzJywgKCkgPT4ge1xuICAgICAgICAgIGxldCBnb29kb3V0Ok5GVE1pbnRPdXRwdXQgPSBuZXcgTkZUTWludE91dHB1dCgwLCBhZGRycGF5LCBmYWxsTG9ja3RpbWUsIDEpO1xuICAgICAgICAgIGxldCBvdXRwYXltZW50Ok91dHB1dCA9IFNlbGVjdE91dHB1dENsYXNzKGdvb2RvdXQuZ2V0T3V0cHV0SUQoKSk7XG4gICAgICAgICAgZXhwZWN0KG91dHBheW1lbnQpLnRvQmVJbnN0YW5jZU9mKE5GVE1pbnRPdXRwdXQpO1xuICAgICAgICAgIGV4cGVjdCgoKSA9PiB7XG4gICAgICAgICAgICAgIFNlbGVjdE91dHB1dENsYXNzKDk5KTtcbiAgICAgICAgICB9KS50b1Rocm93KFwiRXJyb3IgLSBTZWxlY3RPdXRwdXRDbGFzczogdW5rbm93biBvdXRwdXRpZFwiKTtcbiAgICAgIH0pO1xuXG4gICAgICB0ZXN0KCdjb21wYXJhdG9yJywgKCkgPT4ge1xuICAgICAgICAgIGxldCBvdXRwYXltZW50MTpPdXRwdXQgPSBuZXcgTkZUTWludE91dHB1dCgxLCBhZGRycywgZmFsbExvY2t0aW1lLCAxKTtcbiAgICAgICAgICBsZXQgb3V0cGF5bWVudDI6T3V0cHV0ID0gbmV3IE5GVE1pbnRPdXRwdXQoMiwgYWRkcnMsIGZhbGxMb2NrdGltZSwgMSk7XG4gICAgICAgICAgbGV0IG91dHBheW1lbnQzOk91dHB1dCA9IG5ldyBORlRNaW50T3V0cHV0KDAsIGFkZHJzLCBmYWxsTG9ja3RpbWUsIDEpO1xuICAgICAgICAgIGxldCBjbXAgPSBPdXRwdXQuY29tcGFyYXRvcigpO1xuICAgICAgICAgIGV4cGVjdChjbXAob3V0cGF5bWVudDEsIG91dHBheW1lbnQxKSkudG9CZSgwKTtcbiAgICAgICAgICBleHBlY3QoY21wKG91dHBheW1lbnQyLCBvdXRwYXltZW50MikpLnRvQmUoMCk7XG4gICAgICAgICAgZXhwZWN0KGNtcChvdXRwYXltZW50Mywgb3V0cGF5bWVudDMpKS50b0JlKDApO1xuICAgICAgICAgIGV4cGVjdChjbXAob3V0cGF5bWVudDEsIG91dHBheW1lbnQyKSkudG9CZSgtMSk7XG4gICAgICAgICAgZXhwZWN0KGNtcChvdXRwYXltZW50MSwgb3V0cGF5bWVudDMpKS50b0JlKDEpO1xuICAgICAgfSk7XG5cbiAgICAgIHRlc3QoXCJORlRNaW50T3V0cHV0IGNvZGVjSURzXCIsICgpOiB2b2lkID0+IHtcbiAgICAgICAgICBjb25zdCBuZnRNaW50T3V0cHV0OiBORlRNaW50T3V0cHV0ID0gbmV3IE5GVE1pbnRPdXRwdXQoMSwgYWRkcnMsIGZhbGxMb2NrdGltZSwgMSk7XG4gICAgICAgICAgZXhwZWN0KG5mdE1pbnRPdXRwdXQuZ2V0Q29kZWNJRCgpKS50b0JlKGNvZGVjSURfemVybyk7XG4gICAgICAgICAgZXhwZWN0KG5mdE1pbnRPdXRwdXQuZ2V0T3V0cHV0SUQoKSkudG9CZShBVk1Db25zdGFudHMuTkZUTUlOVE9VVFBVVElEKTtcbiAgICAgICAgICBuZnRNaW50T3V0cHV0LnNldENvZGVjSUQoY29kZWNJRF9vbmUpXG4gICAgICAgICAgZXhwZWN0KG5mdE1pbnRPdXRwdXQuZ2V0Q29kZWNJRCgpKS50b0JlKGNvZGVjSURfb25lKTtcbiAgICAgICAgICBleHBlY3QobmZ0TWludE91dHB1dC5nZXRPdXRwdXRJRCgpKS50b0JlKEFWTUNvbnN0YW50cy5ORlRNSU5UT1VUUFVUSURfQ09ERUNPTkUpO1xuICAgICAgICAgIG5mdE1pbnRPdXRwdXQuc2V0Q29kZWNJRChjb2RlY0lEX3plcm8pXG4gICAgICAgICAgZXhwZWN0KG5mdE1pbnRPdXRwdXQuZ2V0Q29kZWNJRCgpKS50b0JlKGNvZGVjSURfemVybyk7XG4gICAgICAgICAgZXhwZWN0KG5mdE1pbnRPdXRwdXQuZ2V0T3V0cHV0SUQoKSkudG9CZShBVk1Db25zdGFudHMuTkZUTUlOVE9VVFBVVElEKTtcbiAgICAgIH0pO1xuXG4gICAgICB0ZXN0KFwiSW52YWxpZCBORlRNaW50T3V0cHV0IGNvZGVjSURcIiwgKCk6IHZvaWQgPT4ge1xuICAgICAgICAgIGNvbnN0IG5mdE1pbnRPdXRwdXQ6IE5GVE1pbnRPdXRwdXQgPSBuZXcgTkZUTWludE91dHB1dCgxLCBhZGRycywgZmFsbExvY2t0aW1lLCAxKTtcbiAgICAgICAgICBleHBlY3QoKCkgPT4ge1xuICAgICAgICAgICAgbmZ0TWludE91dHB1dC5zZXRDb2RlY0lEKDIpXG4gICAgICAgICAgfSkudG9UaHJvdyhcIkVycm9yIC0gTkZUTWludE91dHB1dC5zZXRDb2RlY0lEOiBpbnZhbGlkIGNvZGVjSUQuIFZhbGlkIGNvZGVjSURzIGFyZSAwIGFuZCAxLlwiKTtcbiAgICAgIH0pO1xuXG4gICAgICB0ZXN0KCdGdW5jdGlvbmFsaXR5JywgKCkgPT4ge1xuICAgICAgICAgIGxldCBvdXQ6TkZUTWludE91dHB1dCA9IG5ldyBORlRNaW50T3V0cHV0KDAsIGFkZHJzLCBmYWxsTG9ja3RpbWUsIDMpO1xuICAgICAgICAgIGV4cGVjdChvdXQuZ2V0T3V0cHV0SUQoKSkudG9CZSgxMCk7XG4gICAgICAgICAgZXhwZWN0KEpTT04uc3RyaW5naWZ5KG91dC5nZXRBZGRyZXNzZXMoKS5zb3J0KCkpKS50b1N0cmljdEVxdWFsKEpTT04uc3RyaW5naWZ5KGFkZHJzLnNvcnQoKSkpO1xuXG4gICAgICAgICAgZXhwZWN0KG91dC5nZXRUaHJlc2hvbGQoKSkudG9CZSgzKTtcbiAgICAgICAgICAvLyBleHBlY3Qob3V0LmdldExvY2t0aW1lKCkudG9OdW1iZXIoKSkudG9CZShsb2NrdGltZS50b051bWJlcigpKTtcblxuICAgICAgICAgIGxldCByID0gb3V0LmdldEFkZHJlc3NJZHgoYWRkcnNbMl0pO1xuICAgICAgICAgIGV4cGVjdChvdXQuZ2V0QWRkcmVzcyhyKSkudG9TdHJpY3RFcXVhbChhZGRyc1syXSk7XG4gICAgICAgICAgZXhwZWN0KCgpID0+IHtcbiAgICAgICAgICAgICAgb3V0LmdldEFkZHJlc3MoNDAwKVxuICAgICAgICAgIH0pLnRvVGhyb3coKTtcblxuICAgICAgICAgIGxldCBiOkJ1ZmZlciA9IG91dC50b0J1ZmZlcigpO1xuICAgICAgICAgIGV4cGVjdChvdXQudG9TdHJpbmcoKSkudG9CZShiaW50b29scy5idWZmZXJUb0I1OChiKSk7XG5cbiAgICAgICAgICBsZXQgczpBcnJheTxCdWZmZXI+ID0gb3V0LmdldFNwZW5kZXJzKGFkZHJzKTtcbiAgICAgICAgICBleHBlY3QoSlNPTi5zdHJpbmdpZnkocy5zb3J0KCkpKS50b0JlKEpTT04uc3RyaW5naWZ5KGFkZHJzLnNvcnQoKSkpO1xuXG4gICAgICAgICAgbGV0IG0xOmJvb2xlYW4gPSBvdXQubWVldHNUaHJlc2hvbGQoW2FkZHJzWzBdXSk7XG4gICAgICAgICAgZXhwZWN0KG0xKS50b0JlKGZhbHNlKTtcbiAgICAgICAgICBsZXQgbTI6Ym9vbGVhbiA9IG91dC5tZWV0c1RocmVzaG9sZChhZGRycywgbmV3IEJOKDEwMCkpO1xuICAgICAgICAgIGV4cGVjdChtMikudG9CZShmYWxzZSk7XG4gICAgICAgICAgbGV0IG0zOmJvb2xlYW4gPSBvdXQubWVldHNUaHJlc2hvbGQoYWRkcnMpO1xuICAgICAgICAgIGV4cGVjdChtMykudG9CZSh0cnVlKTtcbiAgICAgICAgICBsZXQgbTQ6Ym9vbGVhbiA9IG91dC5tZWV0c1RocmVzaG9sZChhZGRycywgbG9ja3RpbWUuYWRkKG5ldyBCTigxMDApKSk7XG4gICAgICAgICAgZXhwZWN0KG00KS50b0JlKHRydWUpO1xuICAgICAgfSk7XG4gICAgfSlcblxuICAgIGRlc2NyaWJlKCdTRUNQVHJhbnNmZXJPdXRwdXQnLCAoKSA9PiB7XG4gICAgICBsZXQgYWRkcnM6QXJyYXk8QnVmZmVyPiA9IFtcbiAgICAgICAgICBiaW50b29scy5jYjU4RGVjb2RlKFwiQjZENHYxVnRQWUxiaVV2WVh0VzRQeDhvRTlpbUMydkdXXCIpLFxuICAgICAgICAgIGJpbnRvb2xzLmNiNThEZWNvZGUoXCJQNXdkUnVaZWFEdDI4ZUhNUDVTM3c5WmRvQmZvN3d1ekZcIiksXG4gICAgICAgICAgYmludG9vbHMuY2I1OERlY29kZShcIjZZM2t5c2pGOWpuSG5Za2RTOXlHQXVvSHlhZTJlTm1lVlwiKVxuICAgICAgXS5zb3J0KCk7XG5cbiAgICAgIGxldCBsb2NrdGltZTpCTiA9IG5ldyBCTig1NDMyMSk7XG4gICAgICBsZXQgYWRkcnBheSA9IFthZGRyc1swXSwgYWRkcnNbMV1dO1xuICAgICAgbGV0IGZhbGxMb2NrdGltZTpCTiA9IGxvY2t0aW1lLmFkZChuZXcgQk4oNTApKTtcblxuICAgICAgdGVzdCgnU2VsZWN0T3V0cHV0Q2xhc3MnLCAoKSA9PiB7XG4gICAgICAgICAgbGV0IGdvb2RvdXQ6U0VDUFRyYW5zZmVyT3V0cHV0ID0gbmV3IFNFQ1BUcmFuc2Zlck91dHB1dChuZXcgQk4oMjYwMCksIGFkZHJwYXksIGZhbGxMb2NrdGltZSwgMSk7XG4gICAgICAgICAgbGV0IG91dHBheW1lbnQ6T3V0cHV0ID0gU2VsZWN0T3V0cHV0Q2xhc3MoZ29vZG91dC5nZXRPdXRwdXRJRCgpKTtcbiAgICAgICAgICBleHBlY3Qob3V0cGF5bWVudCkudG9CZUluc3RhbmNlT2YoU0VDUFRyYW5zZmVyT3V0cHV0KTtcbiAgICAgICAgICBleHBlY3QoKCkgPT4ge1xuICAgICAgICAgICAgICBTZWxlY3RPdXRwdXRDbGFzcyg5OSk7XG4gICAgICAgICAgfSkudG9UaHJvdyhcIkVycm9yIC0gU2VsZWN0T3V0cHV0Q2xhc3M6IHVua25vd24gb3V0cHV0aWRcIik7XG4gICAgICB9KTtcblxuICAgICAgdGVzdCgnY29tcGFyYXRvcicsICgpID0+IHtcbiAgICAgICAgICBsZXQgb3V0cGF5bWVudDE6T3V0cHV0ID0gbmV3IFNFQ1BUcmFuc2Zlck91dHB1dChuZXcgQk4oMTAwMDApLCBhZGRycywgbG9ja3RpbWUsIDMpO1xuICAgICAgICAgIGxldCBvdXRwYXltZW50MjpPdXRwdXQgPSBuZXcgU0VDUFRyYW5zZmVyT3V0cHV0KG5ldyBCTigxMDAwMSksIGFkZHJzLCBsb2NrdGltZSwgMyk7XG4gICAgICAgICAgbGV0IG91dHBheW1lbnQzOk91dHB1dCA9IG5ldyBTRUNQVHJhbnNmZXJPdXRwdXQobmV3IEJOKDk5OTkpLCBhZGRycywgbG9ja3RpbWUsIDMpO1xuICAgICAgICAgIGxldCBjbXAgPSBPdXRwdXQuY29tcGFyYXRvcigpO1xuICAgICAgICAgIGV4cGVjdChjbXAob3V0cGF5bWVudDEsIG91dHBheW1lbnQxKSkudG9CZSgwKTtcbiAgICAgICAgICBleHBlY3QoY21wKG91dHBheW1lbnQyLCBvdXRwYXltZW50MikpLnRvQmUoMCk7XG4gICAgICAgICAgZXhwZWN0KGNtcChvdXRwYXltZW50Mywgb3V0cGF5bWVudDMpKS50b0JlKDApO1xuICAgICAgICAgIGV4cGVjdChjbXAob3V0cGF5bWVudDEsIG91dHBheW1lbnQyKSkudG9CZSgtMSk7XG4gICAgICAgICAgZXhwZWN0KGNtcChvdXRwYXltZW50MSwgb3V0cGF5bWVudDMpKS50b0JlKDEpO1xuICAgICAgfSk7XG5cbiAgICAgIHRlc3QoJ1NFQ1BUcmFuc2Zlck91dHB1dCcsICgpID0+IHtcbiAgICAgICAgICBsZXQgb3V0OlNFQ1BUcmFuc2Zlck91dHB1dCA9IG5ldyBTRUNQVHJhbnNmZXJPdXRwdXQobmV3IEJOKDEwMDAwKSwgYWRkcnMsIGxvY2t0aW1lLCAzKTtcbiAgICAgICAgICBleHBlY3Qob3V0LmdldE91dHB1dElEKCkpLnRvQmUoNyk7XG4gICAgICAgICAgZXhwZWN0KEpTT04uc3RyaW5naWZ5KG91dC5nZXRBZGRyZXNzZXMoKS5zb3J0KCkpKS50b1N0cmljdEVxdWFsKEpTT04uc3RyaW5naWZ5KGFkZHJzLnNvcnQoKSkpO1xuXG4gICAgICAgICAgZXhwZWN0KG91dC5nZXRUaHJlc2hvbGQoKSkudG9CZSgzKTtcbiAgICAgICAgICBleHBlY3Qob3V0LmdldExvY2t0aW1lKCkudG9OdW1iZXIoKSkudG9CZShsb2NrdGltZS50b051bWJlcigpKTtcblxuICAgICAgICAgIGxldCByID0gb3V0LmdldEFkZHJlc3NJZHgoYWRkcnNbMl0pO1xuICAgICAgICAgIGV4cGVjdChvdXQuZ2V0QWRkcmVzcyhyKSkudG9TdHJpY3RFcXVhbChhZGRyc1syXSk7XG4gICAgICAgICAgZXhwZWN0KCgpID0+IHtcbiAgICAgICAgICAgICAgb3V0LmdldEFkZHJlc3MoNDAwKVxuICAgICAgICAgIH0pLnRvVGhyb3coKTtcblxuICAgICAgICAgIGV4cGVjdChvdXQuZ2V0QW1vdW50KCkudG9OdW1iZXIoKSkudG9CZSgxMDAwMCk7XG5cbiAgICAgICAgICBsZXQgYjpCdWZmZXIgPSBvdXQudG9CdWZmZXIoKTtcbiAgICAgICAgICBleHBlY3Qob3V0LnRvU3RyaW5nKCkpLnRvQmUoYmludG9vbHMuYnVmZmVyVG9CNTgoYikpO1xuXG4gICAgICAgICAgbGV0IHM6QXJyYXk8QnVmZmVyPiA9IG91dC5nZXRTcGVuZGVycyhhZGRycyk7XG4gICAgICAgICAgZXhwZWN0KEpTT04uc3RyaW5naWZ5KHMuc29ydCgpKSkudG9CZShKU09OLnN0cmluZ2lmeShhZGRycy5zb3J0KCkpKTtcblxuICAgICAgICAgIGxldCBtMTpib29sZWFuID0gb3V0Lm1lZXRzVGhyZXNob2xkKFthZGRyc1swXV0pO1xuICAgICAgICAgIGV4cGVjdChtMSkudG9CZShmYWxzZSk7XG4gICAgICAgICAgbGV0IG0yOmJvb2xlYW4gPSBvdXQubWVldHNUaHJlc2hvbGQoYWRkcnMsIG5ldyBCTigxMDApKTtcbiAgICAgICAgICBleHBlY3QobTIpLnRvQmUoZmFsc2UpO1xuICAgICAgICAgIGxldCBtMzpib29sZWFuID0gb3V0Lm1lZXRzVGhyZXNob2xkKGFkZHJzKTtcbiAgICAgICAgICBleHBlY3QobTMpLnRvQmUodHJ1ZSk7XG4gICAgICAgICAgbGV0IG00OmJvb2xlYW4gPSBvdXQubWVldHNUaHJlc2hvbGQoYWRkcnMsIGxvY2t0aW1lLmFkZChuZXcgQk4oMTAwKSkpO1xuICAgICAgICAgIGV4cGVjdChtNCkudG9CZSh0cnVlKTtcbiAgICAgIH0pO1xuXG4gICAgICB0ZXN0KFwiU0VDUFRyYW5zZmVyT3V0cHV0IGNvZGVjSURzXCIsICgpID0+IHtcbiAgICAgICAgY29uc3Qgc2VjUFRyYW5zZmVyT3V0cHV0OiBTRUNQVHJhbnNmZXJPdXRwdXQgPSBuZXcgU0VDUFRyYW5zZmVyT3V0cHV0KG5ldyBCTigxMDAwMCksIGFkZHJzLCBsb2NrdGltZSwgMyk7XG4gICAgICAgIGV4cGVjdChzZWNQVHJhbnNmZXJPdXRwdXQuZ2V0Q29kZWNJRCgpKS50b0JlKGNvZGVjSURfemVybyk7XG4gICAgICAgIGV4cGVjdChzZWNQVHJhbnNmZXJPdXRwdXQuZ2V0T3V0cHV0SUQoKSkudG9CZShBVk1Db25zdGFudHMuU0VDUFhGRVJPVVRQVVRJRCk7XG4gICAgICAgIHNlY1BUcmFuc2Zlck91dHB1dC5zZXRDb2RlY0lEKGNvZGVjSURfb25lKVxuICAgICAgICBleHBlY3Qoc2VjUFRyYW5zZmVyT3V0cHV0LmdldENvZGVjSUQoKSkudG9CZShjb2RlY0lEX29uZSk7XG4gICAgICAgIGV4cGVjdChzZWNQVHJhbnNmZXJPdXRwdXQuZ2V0T3V0cHV0SUQoKSkudG9CZShBVk1Db25zdGFudHMuU0VDUFhGRVJPVVRQVVRJRF9DT0RFQ09ORSk7XG4gICAgICAgIHNlY1BUcmFuc2Zlck91dHB1dC5zZXRDb2RlY0lEKGNvZGVjSURfemVybylcbiAgICAgICAgZXhwZWN0KHNlY1BUcmFuc2Zlck91dHB1dC5nZXRDb2RlY0lEKCkpLnRvQmUoY29kZWNJRF96ZXJvKTtcbiAgICAgICAgZXhwZWN0KHNlY1BUcmFuc2Zlck91dHB1dC5nZXRPdXRwdXRJRCgpKS50b0JlKEFWTUNvbnN0YW50cy5TRUNQWEZFUk9VVFBVVElEKTtcbiAgICAgIH0pO1xuXG4gICAgICB0ZXN0KFwiSW52YWxpZCBTRUNQVHJhbnNmZXJPdXRwdXQgY29kZWNJRFwiLCAoKTogdm9pZCA9PiB7XG4gICAgICAgICAgY29uc3Qgc2VjUFRyYW5zZmVyT3V0cHV0OiBTRUNQVHJhbnNmZXJPdXRwdXQgPSBuZXcgU0VDUFRyYW5zZmVyT3V0cHV0KG5ldyBCTigxMDAwMCksIGFkZHJzLCBsb2NrdGltZSwgMyk7XG4gICAgICAgICAgZXhwZWN0KCgpID0+IHtcbiAgICAgICAgICAgIHNlY1BUcmFuc2Zlck91dHB1dC5zZXRDb2RlY0lEKDIpXG4gICAgICAgICAgfSkudG9UaHJvdyhcIkVycm9yIC0gU0VDUFRyYW5zZmVyT3V0cHV0LnNldENvZGVjSUQ6IGludmFsaWQgY29kZWNJRC4gVmFsaWQgY29kZWNJRHMgYXJlIDAgYW5kIDEuXCIpO1xuICAgICAgfSk7XG5cbiAgICAgIHRlc3QoJ1NFQ1BNaW50T3V0cHV0JywgKCkgPT4ge1xuICAgICAgICBsZXQgb3V0OlNFQ1BNaW50T3V0cHV0ID0gbmV3IFNFQ1BNaW50T3V0cHV0KGFkZHJzLCBsb2NrdGltZSwgMyk7XG4gICAgICAgIGV4cGVjdChvdXQuZ2V0T3V0cHV0SUQoKSkudG9CZSg2KTtcbiAgICAgICAgZXhwZWN0KEpTT04uc3RyaW5naWZ5KG91dC5nZXRBZGRyZXNzZXMoKS5zb3J0KCkpKS50b1N0cmljdEVxdWFsKEpTT04uc3RyaW5naWZ5KGFkZHJzLnNvcnQoKSkpO1xuXG4gICAgICAgIGV4cGVjdChvdXQuZ2V0VGhyZXNob2xkKCkpLnRvQmUoMyk7XG4gICAgICAgIGV4cGVjdChvdXQuZ2V0TG9ja3RpbWUoKS50b051bWJlcigpKS50b0JlKGxvY2t0aW1lLnRvTnVtYmVyKCkpO1xuXG4gICAgICAgIGxldCByID0gb3V0LmdldEFkZHJlc3NJZHgoYWRkcnNbMl0pO1xuICAgICAgICBleHBlY3Qob3V0LmdldEFkZHJlc3MocikpLnRvU3RyaWN0RXF1YWwoYWRkcnNbMl0pO1xuICAgICAgICBleHBlY3QoKCkgPT4ge1xuICAgICAgICAgICAgb3V0LmdldEFkZHJlc3MoNDAwKVxuICAgICAgICB9KS50b1Rocm93KCk7XG5cbiAgICAgICAgbGV0IGI6QnVmZmVyID0gb3V0LnRvQnVmZmVyKCk7XG4gICAgICAgIGV4cGVjdChvdXQudG9TdHJpbmcoKSkudG9CZShiaW50b29scy5idWZmZXJUb0I1OChiKSk7XG5cbiAgICAgICAgbGV0IHM6QXJyYXk8QnVmZmVyPiA9IG91dC5nZXRTcGVuZGVycyhhZGRycyk7XG4gICAgICAgIGV4cGVjdChKU09OLnN0cmluZ2lmeShzLnNvcnQoKSkpLnRvQmUoSlNPTi5zdHJpbmdpZnkoYWRkcnMuc29ydCgpKSk7XG5cbiAgICAgICAgbGV0IG0xOmJvb2xlYW4gPSBvdXQubWVldHNUaHJlc2hvbGQoW2FkZHJzWzBdXSk7XG4gICAgICAgIGV4cGVjdChtMSkudG9CZShmYWxzZSk7XG4gICAgICAgIGxldCBtMjpib29sZWFuID0gb3V0Lm1lZXRzVGhyZXNob2xkKGFkZHJzLCBuZXcgQk4oMTAwKSk7XG4gICAgICAgIGV4cGVjdChtMikudG9CZShmYWxzZSk7XG4gICAgICAgIGxldCBtMzpib29sZWFuID0gb3V0Lm1lZXRzVGhyZXNob2xkKGFkZHJzKTtcbiAgICAgICAgZXhwZWN0KG0zKS50b0JlKHRydWUpO1xuICAgICAgICBsZXQgbTQ6Ym9vbGVhbiA9IG91dC5tZWV0c1RocmVzaG9sZChhZGRycywgbG9ja3RpbWUuYWRkKG5ldyBCTigxMDApKSk7XG4gICAgICAgIGV4cGVjdChtNCkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgICAgdGVzdChcIlNFQ1BNaW50T3V0cHV0IGNvZGVjSURzXCIsICgpID0+IHtcbiAgICAgICAgbGV0IHNlY3BNaW50T3V0cHV0OiBTRUNQTWludE91dHB1dCA9IG5ldyBTRUNQTWludE91dHB1dChhZGRycywgbG9ja3RpbWUsIDMpO1xuICAgICAgICBleHBlY3Qoc2VjcE1pbnRPdXRwdXQuZ2V0Q29kZWNJRCgpKS50b0JlKGNvZGVjSURfemVybyk7XG4gICAgICAgIGV4cGVjdChzZWNwTWludE91dHB1dC5nZXRPdXRwdXRJRCgpKS50b0JlKEFWTUNvbnN0YW50cy5TRUNQTUlOVE9VVFBVVElEKTtcbiAgICAgICAgc2VjcE1pbnRPdXRwdXQuc2V0Q29kZWNJRChjb2RlY0lEX29uZSlcbiAgICAgICAgZXhwZWN0KHNlY3BNaW50T3V0cHV0LmdldENvZGVjSUQoKSkudG9CZShjb2RlY0lEX29uZSk7XG4gICAgICAgIGV4cGVjdChzZWNwTWludE91dHB1dC5nZXRPdXRwdXRJRCgpKS50b0JlKEFWTUNvbnN0YW50cy5TRUNQTUlOVE9VVFBVVElEX0NPREVDT05FKTtcbiAgICAgICAgc2VjcE1pbnRPdXRwdXQuc2V0Q29kZWNJRChjb2RlY0lEX3plcm8pXG4gICAgICAgIGV4cGVjdChzZWNwTWludE91dHB1dC5nZXRDb2RlY0lEKCkpLnRvQmUoY29kZWNJRF96ZXJvKTtcbiAgICAgICAgZXhwZWN0KHNlY3BNaW50T3V0cHV0LmdldE91dHB1dElEKCkpLnRvQmUoQVZNQ29uc3RhbnRzLlNFQ1BNSU5UT1VUUFVUSUQpO1xuICAgICAgfSk7XG5cbiAgICAgIHRlc3QoXCJJbnZhbGlkIFNFQ1BNaW50T3V0cHV0IGNvZGVjSURcIiwgKCk6IHZvaWQgPT4ge1xuICAgICAgICAgIGNvbnN0IHNlY3BNaW50T3V0cHV0OiBTRUNQTWludE91dHB1dCA9IG5ldyBTRUNQTWludE91dHB1dChhZGRycywgbG9ja3RpbWUsIDMpO1xuICAgICAgICAgIGV4cGVjdCgoKSA9PiB7XG4gICAgICAgICAgICBzZWNwTWludE91dHB1dC5zZXRDb2RlY0lEKDIpXG4gICAgICAgICAgfSkudG9UaHJvdyhcIkVycm9yIC0gU0VDUE1pbnRPdXRwdXQuc2V0Q29kZWNJRDogaW52YWxpZCBjb2RlY0lELiBWYWxpZCBjb2RlY0lEcyBhcmUgMCBhbmQgMS5cIik7XG4gICAgICB9KTtcbiAgICB9KTtcbn0pO1xuIl19