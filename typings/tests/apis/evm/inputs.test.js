"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const utxos_1 = require("src/apis/avm/utxos");
const keychain_1 = require("src/apis/avm/keychain");
const inputs_1 = require("src/apis/avm/inputs");
const create_hash_1 = __importDefault(require("create-hash"));
const bintools_1 = __importDefault(require("src/utils/bintools"));
const bn_js_1 = __importDefault(require("bn.js"));
const buffer_1 = require("buffer/");
const outputs_1 = require("src/apis/avm/outputs");
const constants_1 = require("src/apis/evm/constants");
const input_1 = require("src/common/input");
const evm_1 = require("src/apis/evm");
/**
 * @ignore
 */
const bintools = bintools_1.default.getInstance();
describe('Inputs', () => {
    let set;
    let keymgr1;
    let keymgr2;
    let addrs1;
    let addrs2;
    let utxos;
    let hrp = "tests";
    const amnt = 10000;
    beforeEach(() => {
        set = new utxos_1.UTXOSet();
        keymgr1 = new keychain_1.KeyChain(hrp, 'C');
        keymgr2 = new keychain_1.KeyChain(hrp, 'C');
        addrs1 = [];
        addrs2 = [];
        utxos = [];
        for (let i = 0; i < 3; i++) {
            addrs1.push(keymgr1.makeKey().getAddress());
            addrs2.push(keymgr2.makeKey().getAddress());
        }
        const amount = new bn_js_1.default(amnt);
        const addresses = keymgr1.getAddresses();
        const locktime = new bn_js_1.default(54321);
        const threshold = 3;
        for (let i = 0; i < 3; i++) {
            const txid = buffer_1.Buffer.from(create_hash_1.default('sha256').update(bintools.fromBNToBuffer(new bn_js_1.default(i), 32)).digest());
            const txidx = buffer_1.Buffer.from(bintools.fromBNToBuffer(new bn_js_1.default(i), 4));
            const assetID = buffer_1.Buffer.from(create_hash_1.default('sha256').update(txid).digest());
            const out = new outputs_1.SECPTransferOutput(amount.add(new bn_js_1.default(i)), addresses, locktime, threshold);
            const xferout = new outputs_1.TransferableOutput(assetID, out);
            const u = new utxos_1.UTXO(constants_1.EVMConstants.LATESTCODEC, txid, txidx, assetID, out);
            u.fromBuffer(buffer_1.Buffer.concat([u.getCodecIDBuffer(), txid, txidx, xferout.toBuffer()]));
            utxos.push(u);
        }
        set.addArray(utxos);
    });
    test('SECPInput', () => {
        let u;
        let txid;
        let txidx;
        const amount = new bn_js_1.default(amnt);
        let input;
        let xferinput;
        u = utxos[0];
        txid = u.getTxID();
        txidx = u.getOutputIdx();
        const asset = u.getAssetID();
        input = new inputs_1.SECPTransferInput(amount);
        xferinput = new inputs_1.TransferableInput(txid, txidx, asset, input);
        expect(xferinput.getUTXOID()).toBe(u.getUTXOID());
        expect(input.getInputID()).toBe(constants_1.EVMConstants.SECPINPUTID);
        input.addSignatureIdx(0, addrs2[0]);
        input.addSignatureIdx(1, addrs2[1]);
        const newin = new inputs_1.SECPTransferInput();
        newin.fromBuffer(bintools.b58ToBuffer(input.toString()));
        expect(newin.toBuffer().toString('hex')).toBe(input.toBuffer().toString('hex'));
        expect(newin.getSigIdxs().toString()).toBe(input.getSigIdxs().toString());
    });
    test('Input comparator', () => {
        const inpt1 = new inputs_1.SECPTransferInput(utxos[0].getOutput().getAmount());
        const inpt2 = new inputs_1.SECPTransferInput(utxos[1].getOutput().getAmount());
        const inpt3 = new inputs_1.SECPTransferInput(utxos[2].getOutput().getAmount());
        const cmp = input_1.Input.comparator();
        expect(cmp(inpt1, inpt2)).toBe(-1);
        expect(cmp(inpt1, inpt3)).toBe(-1);
        expect(cmp(inpt1, inpt1)).toBe(0);
        expect(cmp(inpt2, inpt2)).toBe(0);
        expect(cmp(inpt3, inpt3)).toBe(0);
    });
    test('TransferableInput comparator', () => {
        const inpt1 = new inputs_1.SECPTransferInput(utxos[0].getOutput().getAmount());
        const in1 = new inputs_1.TransferableInput(utxos[0].getTxID(), utxos[0].getOutputIdx(), utxos[0].getAssetID(), inpt1);
        const inpt2 = new inputs_1.SECPTransferInput(utxos[1].getOutput().getAmount());
        const in2 = new inputs_1.TransferableInput(utxos[1].getTxID(), utxos[1].getOutputIdx(), utxos[1].getAssetID(), inpt2);
        const inpt3 = new inputs_1.SECPTransferInput(utxos[2].getOutput().getAmount());
        const in3 = new inputs_1.TransferableInput(utxos[2].getTxID(), utxos[2].getOutputIdx(), utxos[2].getAssetID(), inpt3);
        const cmp = inputs_1.TransferableInput.comparator();
        expect(cmp(in1, in2)).toBe(-1);
        expect(cmp(in1, in3)).toBe(-1);
        expect(cmp(in1, in1)).toBe(0);
        expect(cmp(in2, in2)).toBe(0);
        expect(cmp(in3, in3)).toBe(0);
    });
    test('EVMInput comparator', () => {
        let inputs = [];
        const address1 = "0x55ee05dF718f1a5C1441e76190EB1a19eE2C9430";
        const address3 = "0x9632a79656af553F58738B0FB750320158495942";
        const address4 = "0x4Cf2eD3665F6bFA95cE6A11CFDb7A2EF5FC1C7E4";
        const address6 = "0x3C7daE394BBf8e9EE1359ad14C1C47003bD06293";
        const address8 = "0x0Fa8EA536Be85F32724D57A37758761B86416123";
        const amount1 = 1;
        const amount2 = 2;
        const amount3 = 3;
        const amount4 = 4;
        const amount5 = 5;
        const amount6 = 6;
        const amount7 = 7;
        const amount8 = 8;
        const assetID1 = "2fombhL7aGPwj3KH4bfrmJwW6PVnMobf9Y2fn9GwxiAAJyFDbe"; // dbcf890f77f49b96857648b72b77f9f82937f28a68704af05da0dc12ba53f2db
        const assetID2 = "vvKCjrpggyQ8FhJ2D5EAKPh8x8y4JK93JQiWRpTKpEouydRbG"; // 7a6e1e3c9c66ed8f076180f89d01320795628dca633001ff437ac6ab58b455be
        const assetID3 = "eRo1eb2Yxd87KuMYANBSha3n138wtqRhFz2xjftsXWnmpCxyh"; // 54fbd087a8a9c739c2c7926d742ea7b937adbd512b9ff0fd51f460a763d1371a
        const assetID5 = "2QqUTT3XTgR6HLbCLGtjN2uDHHqNRaBgtBGJ5KCqW7BUaH1P8X"; // b9d16d7c7d2674c3c67c5c26d9d6e39a09a5991c588cdf60c4cca732b66fa749
        const assetID6 = "ZWXaLcAy1YWS3Vvjcrt2KcVA4VxBsMFt8yNDZABJkgBvgpRti"; // 49d0dc67846a20dfea79b7beeba84769efa4a0273575f65ca79f9dee1cd1250e
        const assetID7 = "FHfS61NfF5XdZU62bcXp9yRfgrZeiQC7VNJWKcpdb9QMLHs4L"; // 2070e77e34941439dc7bcf502dcf555c6ef0e3cc46bbac8a03b22e15c84a81f1
        const assetID8 = "ZL6NeWgcnxR2zhhKDx7h9Kg2mZgScC5N4RG5FCDayWY7W3whZ"; // 496849239bb1541e97fa8f89256965bf7e657f3bb530cad820dd41706c5e3836
        const nonce1 = 0;
        const nonce2 = 1;
        const nonce3 = 2;
        const nonce4 = 3;
        const nonce5 = 4;
        const nonce6 = 5;
        const nonce7 = 6;
        const nonce8 = 7;
        const input1 = new evm_1.EVMInput(address1, amount1, assetID1, nonce1);
        inputs.push(input1);
        const input2 = new evm_1.EVMInput(address1, amount2, assetID2, nonce2);
        inputs.push(input2);
        const input3 = new evm_1.EVMInput(address3, amount3, assetID2, nonce3);
        inputs.push(input3);
        const input4 = new evm_1.EVMInput(address4, amount4, assetID3, nonce4);
        inputs.push(input4);
        const input5 = new evm_1.EVMInput(address1, amount5, assetID5, nonce5);
        inputs.push(input5);
        const input6 = new evm_1.EVMInput(address6, amount6, assetID6, nonce6);
        inputs.push(input6);
        const input7 = new evm_1.EVMInput(address1, amount7, assetID7, nonce7);
        inputs.push(input7);
        const input8 = new evm_1.EVMInput(address8, amount8, assetID8, nonce8);
        inputs.push(input8);
        inputs = inputs.sort(evm_1.EVMInput.comparator());
        expect(inputs[0].getAmount().toString()).toBe("8");
        expect(inputs[1].getAmount().toString()).toBe("6");
        expect(inputs[2].getAmount().toString()).toBe("4");
        expect(inputs[3].getAmount().toString()).toBe("7");
        expect(inputs[4].getAmount().toString()).toBe("2");
        expect(inputs[5].getAmount().toString()).toBe("5");
        expect(inputs[6].getAmount().toString()).toBe("1");
        expect(inputs[7].getAmount().toString()).toBe("3");
        const cmp = evm_1.EVMInput.comparator();
        expect(cmp(input2, input1)).toBe(-1);
        expect(cmp(input1, input3)).toBe(-1);
        expect(cmp(input2, input3)).toBe(-1);
        expect(cmp(input1, input1)).toBe(0);
        expect(cmp(input2, input2)).toBe(0);
        expect(cmp(input3, input3)).toBe(0);
        expect(cmp(input1, input2)).toBe(1);
        expect(cmp(input3, input1)).toBe(1);
        expect(cmp(input3, input2)).toBe(1);
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5wdXRzLnRlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi90ZXN0cy9hcGlzL2V2bS9pbnB1dHMudGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLDhDQUFtRDtBQUNuRCxvREFBaUQ7QUFDakQsZ0RBQTJFO0FBQzNFLDhEQUFxQztBQUNyQyxrRUFBMEM7QUFDMUMsa0RBQXVCO0FBQ3ZCLG9DQUFpQztBQUNqQyxrREFFOEI7QUFDOUIsc0RBQXNEO0FBQ3RELDRDQUF5QztBQUV6QyxzQ0FBd0M7QUFFeEM7O0dBRUc7QUFDSCxNQUFNLFFBQVEsR0FBRyxrQkFBUSxDQUFDLFdBQVcsRUFBRSxDQUFDO0FBQ3hDLFFBQVEsQ0FBQyxRQUFRLEVBQUUsR0FBRyxFQUFFO0lBQ3RCLElBQUksR0FBWSxDQUFDO0lBQ2pCLElBQUksT0FBaUIsQ0FBQztJQUN0QixJQUFJLE9BQWlCLENBQUM7SUFDdEIsSUFBSSxNQUFnQixDQUFDO0lBQ3JCLElBQUksTUFBZ0IsQ0FBQztJQUNyQixJQUFJLEtBQWEsQ0FBQztJQUNsQixJQUFJLEdBQUcsR0FBVyxPQUFPLENBQUM7SUFDMUIsTUFBTSxJQUFJLEdBQVcsS0FBSyxDQUFDO0lBQzNCLFVBQVUsQ0FBQyxHQUFHLEVBQUU7UUFDZCxHQUFHLEdBQUcsSUFBSSxlQUFPLEVBQUUsQ0FBQztRQUNwQixPQUFPLEdBQUcsSUFBSSxtQkFBUSxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQztRQUNqQyxPQUFPLEdBQUcsSUFBSSxtQkFBUSxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQztRQUNqQyxNQUFNLEdBQUcsRUFBRSxDQUFDO1FBQ1osTUFBTSxHQUFHLEVBQUUsQ0FBQztRQUNaLEtBQUssR0FBRyxFQUFFLENBQUM7UUFDWCxLQUFLLElBQUksQ0FBQyxHQUFXLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFO1lBQ2xDLE1BQU0sQ0FB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QUFDLFFBQVEsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ25ELE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxFQUFFLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDbkQsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNuRCxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsRUFBRSxDQUFDLFFBQVEsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBRW5ELE1BQU0sR0FBRyxHQUFHLGNBQVEsQ0FBQyxVQUFVLEVBQUUsQ0FBQztRQUNsQyxNQUFNLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3JDLE1BQU0sQ0FBQyxHQUFHLENBQUMsTUFBTSxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDckMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxNQUFNLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNyQyxNQUFNLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNwQyxNQUFNLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNwQyxNQUFNLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNwQyxNQUFNLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNwQyxNQUFNLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNwQyxNQUFNLENBQUMsR0FBRyxDQUFDLE1BQU0sRUFBRSxNQUFNLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUN0QyxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVVRYT1NldCwgVVRYTyB9IGZyb20gJ3NyYy9hcGlzL2F2bS91dHhvcyc7XG5pbXBvcnQgeyBLZXlDaGFpbiB9IGZyb20gJ3NyYy9hcGlzL2F2bS9rZXljaGFpbic7XG5pbXBvcnQgeyBTRUNQVHJhbnNmZXJJbnB1dCwgVHJhbnNmZXJhYmxlSW5wdXQgfSBmcm9tICdzcmMvYXBpcy9hdm0vaW5wdXRzJztcbmltcG9ydCBjcmVhdGVIYXNoIGZyb20gJ2NyZWF0ZS1oYXNoJztcbmltcG9ydCBCaW5Ub29scyBmcm9tICdzcmMvdXRpbHMvYmludG9vbHMnO1xuaW1wb3J0IEJOIGZyb20gJ2JuLmpzJztcbmltcG9ydCB7IEJ1ZmZlciB9IGZyb20gJ2J1ZmZlci8nO1xuaW1wb3J0IHtcbiAgU0VDUFRyYW5zZmVyT3V0cHV0LCBBbW91bnRPdXRwdXQsIFRyYW5zZmVyYWJsZU91dHB1dCxcbn0gZnJvbSAnc3JjL2FwaXMvYXZtL291dHB1dHMnO1xuaW1wb3J0IHsgRVZNQ29uc3RhbnRzIH0gZnJvbSAnc3JjL2FwaXMvZXZtL2NvbnN0YW50cyc7XG5pbXBvcnQgeyBJbnB1dCB9IGZyb20gJ3NyYy9jb21tb24vaW5wdXQnO1xuaW1wb3J0IHsgT3V0cHV0IH0gZnJvbSAnc3JjL2NvbW1vbi9vdXRwdXQnO1xuaW1wb3J0IHsgRVZNSW5wdXQgfSBmcm9tICdzcmMvYXBpcy9ldm0nO1xuXG4vKipcbiAqIEBpZ25vcmVcbiAqL1xuY29uc3QgYmludG9vbHMgPSBCaW5Ub29scy5nZXRJbnN0YW5jZSgpO1xuZGVzY3JpYmUoJ0lucHV0cycsICgpID0+IHtcbiAgbGV0IHNldDogVVRYT1NldDtcbiAgbGV0IGtleW1ncjE6IEtleUNoYWluO1xuICBsZXQga2V5bWdyMjogS2V5Q2hhaW47XG4gIGxldCBhZGRyczE6IEJ1ZmZlcltdO1xuICBsZXQgYWRkcnMyOiBCdWZmZXJbXTtcbiAgbGV0IHV0eG9zOiBVVFhPW107XG4gIGxldCBocnA6IHN0cmluZyA9IFwidGVzdHNcIjtcbiAgY29uc3QgYW1udDogbnVtYmVyID0gMTAwMDA7XG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIHNldCA9IG5ldyBVVFhPU2V0KCk7XG4gICAga2V5bWdyMSA9IG5ldyBLZXlDaGFpbihocnAsICdDJyk7XG4gICAga2V5bWdyMiA9IG5ldyBLZXlDaGFpbihocnAsICdDJyk7XG4gICAgYWRkcnMxID0gW107XG4gICAgYWRkcnMyID0gW107XG4gICAgdXR4b3MgPSBbXTtcbiAgICBmb3IgKGxldCBpOiBudW1iZXIgPSAwOyBpIDwgMzsgaSsrKSB7XG4gICAgICBhZGRyczEucHVzaChrZXltZ3IxLm1ha2VLZXkoKS5nZXRBZGRyZXNzKCkpO1xuICAgICAgYWRkcnMyLnB1c2goa2V5bWdyMi5tYWtlS2V5KCkuZ2V0QWRkcmVzcygpKTtcbiAgICB9XG4gICAgY29uc3QgYW1vdW50OiBCTiA9IG5ldyBCTihhbW50KTtcbiAgICBjb25zdCBhZGRyZXNzZXM6IEJ1ZmZlcltdID0ga2V5bWdyMS5nZXRBZGRyZXNzZXMoKTtcbiAgICBjb25zdCBsb2NrdGltZTogQk4gPSBuZXcgQk4oNTQzMjEpO1xuICAgIGNvbnN0IHRocmVzaG9sZDogbnVtYmVyID0gMztcblxuICAgIGZvciAobGV0IGk6IG51bWJlciA9IDA7IGkgPCAzOyBpKyspIHtcbiAgICAgIGNvbnN0IHR4aWQ6IEJ1ZmZlciA9IEJ1ZmZlci5mcm9tKGNyZWF0ZUhhc2goJ3NoYTI1NicpLnVwZGF0ZShiaW50b29scy5mcm9tQk5Ub0J1ZmZlcihuZXcgQk4oaSksIDMyKSkuZGlnZXN0KCkpO1xuICAgICAgY29uc3QgdHhpZHg6IEJ1ZmZlciA9IEJ1ZmZlci5mcm9tKGJpbnRvb2xzLmZyb21CTlRvQnVmZmVyKG5ldyBCTihpKSwgNCkpO1xuICAgICAgY29uc3QgYXNzZXRJRDogQnVmZmVyID0gQnVmZmVyLmZyb20oY3JlYXRlSGFzaCgnc2hhMjU2JykudXBkYXRlKHR4aWQpLmRpZ2VzdCgpKTtcbiAgICAgIGNvbnN0IG91dDogT3V0cHV0ID0gbmV3IFNFQ1BUcmFuc2Zlck91dHB1dChhbW91bnQuYWRkKG5ldyBCTihpKSksIGFkZHJlc3NlcywgbG9ja3RpbWUsIHRocmVzaG9sZCk7XG4gICAgICBjb25zdCB4ZmVyb3V0OiBUcmFuc2ZlcmFibGVPdXRwdXQgPSBuZXcgVHJhbnNmZXJhYmxlT3V0cHV0KGFzc2V0SUQsIG91dCk7XG4gICAgICBjb25zdCB1OiBVVFhPID0gbmV3IFVUWE8oRVZNQ29uc3RhbnRzLkxBVEVTVENPREVDLCB0eGlkLCB0eGlkeCwgYXNzZXRJRCwgb3V0KTtcbiAgICAgIHUuZnJvbUJ1ZmZlcihCdWZmZXIuY29uY2F0KFt1LmdldENvZGVjSURCdWZmZXIoKSwgdHhpZCwgdHhpZHgsIHhmZXJvdXQudG9CdWZmZXIoKV0pKTtcbiAgICAgIHV0eG9zLnB1c2godSk7XG4gICAgfVxuICAgIHNldC5hZGRBcnJheSh1dHhvcyk7XG4gIH0pO1xuICB0ZXN0KCdTRUNQSW5wdXQnLCAoKSA9PiB7XG4gICAgbGV0IHU6IFVUWE87XG4gICAgbGV0IHR4aWQ6IEJ1ZmZlcjtcbiAgICBsZXQgdHhpZHg6IEJ1ZmZlcjtcbiAgICBjb25zdCBhbW91bnQ6IEJOID0gbmV3IEJOKGFtbnQpO1xuICAgIGxldCBpbnB1dDogU0VDUFRyYW5zZmVySW5wdXQ7XG4gICAgbGV0IHhmZXJpbnB1dDogVHJhbnNmZXJhYmxlSW5wdXQ7XG5cbiAgICB1ID0gdXR4b3NbMF07XG4gICAgdHhpZCA9IHUuZ2V0VHhJRCgpO1xuICAgIHR4aWR4ID0gdS5nZXRPdXRwdXRJZHgoKTtcbiAgICBjb25zdCBhc3NldCA9IHUuZ2V0QXNzZXRJRCgpO1xuXG4gICAgaW5wdXQgPSBuZXcgU0VDUFRyYW5zZmVySW5wdXQoYW1vdW50KTtcbiAgICB4ZmVyaW5wdXQgPSBuZXcgVHJhbnNmZXJhYmxlSW5wdXQodHhpZCwgdHhpZHgsIGFzc2V0LCBpbnB1dCk7XG4gICAgZXhwZWN0KHhmZXJpbnB1dC5nZXRVVFhPSUQoKSkudG9CZSh1LmdldFVUWE9JRCgpKTtcbiAgICBleHBlY3QoaW5wdXQuZ2V0SW5wdXRJRCgpKS50b0JlKEVWTUNvbnN0YW50cy5TRUNQSU5QVVRJRCk7XG5cbiAgICBpbnB1dC5hZGRTaWduYXR1cmVJZHgoMCwgYWRkcnMyWzBdKTtcbiAgICBpbnB1dC5hZGRTaWduYXR1cmVJZHgoMSwgYWRkcnMyWzFdKTtcblxuICAgIGNvbnN0IG5ld2luOiBTRUNQVHJhbnNmZXJJbnB1dCA9IG5ldyBTRUNQVHJhbnNmZXJJbnB1dCgpO1xuICAgIG5ld2luLmZyb21CdWZmZXIoYmludG9vbHMuYjU4VG9CdWZmZXIoaW5wdXQudG9TdHJpbmcoKSkpO1xuICAgIGV4cGVjdChuZXdpbi50b0J1ZmZlcigpLnRvU3RyaW5nKCdoZXgnKSkudG9CZShpbnB1dC50b0J1ZmZlcigpLnRvU3RyaW5nKCdoZXgnKSk7XG4gICAgZXhwZWN0KG5ld2luLmdldFNpZ0lkeHMoKS50b1N0cmluZygpKS50b0JlKGlucHV0LmdldFNpZ0lkeHMoKS50b1N0cmluZygpKTtcbiAgfSk7XG5cbiAgdGVzdCgnSW5wdXQgY29tcGFyYXRvcicsICgpID0+IHtcbiAgICBjb25zdCBpbnB0MTogU0VDUFRyYW5zZmVySW5wdXQgPSBuZXcgU0VDUFRyYW5zZmVySW5wdXQoKHV0eG9zWzBdLmdldE91dHB1dCgpIGFzIEFtb3VudE91dHB1dCkuZ2V0QW1vdW50KCkpO1xuXG4gICAgY29uc3QgaW5wdDI6IFNFQ1BUcmFuc2ZlcklucHV0ID0gbmV3IFNFQ1BUcmFuc2ZlcklucHV0KCh1dHhvc1sxXS5nZXRPdXRwdXQoKSBhcyBBbW91bnRPdXRwdXQpLmdldEFtb3VudCgpKTtcblxuICAgIGNvbnN0IGlucHQzOiBTRUNQVHJhbnNmZXJJbnB1dCA9IG5ldyBTRUNQVHJhbnNmZXJJbnB1dCgodXR4b3NbMl0uZ2V0T3V0cHV0KCkgYXMgQW1vdW50T3V0cHV0KS5nZXRBbW91bnQoKSk7XG5cbiAgICBjb25zdCBjbXAgPSBJbnB1dC5jb21wYXJhdG9yKCk7XG4gICAgZXhwZWN0KGNtcChpbnB0MSwgaW5wdDIpKS50b0JlKC0xKTtcbiAgICBleHBlY3QoY21wKGlucHQxLCBpbnB0MykpLnRvQmUoLTEpO1xuICAgIGV4cGVjdChjbXAoaW5wdDEsIGlucHQxKSkudG9CZSgwKTtcbiAgICBleHBlY3QoY21wKGlucHQyLCBpbnB0MikpLnRvQmUoMCk7XG4gICAgZXhwZWN0KGNtcChpbnB0MywgaW5wdDMpKS50b0JlKDApO1xuICB9KTtcblxuICB0ZXN0KCdUcmFuc2ZlcmFibGVJbnB1dCBjb21wYXJhdG9yJywgKCkgPT4ge1xuICAgIGNvbnN0IGlucHQxOiBTRUNQVHJhbnNmZXJJbnB1dCA9IG5ldyBTRUNQVHJhbnNmZXJJbnB1dCgodXR4b3NbMF0uZ2V0T3V0cHV0KCkgYXMgQW1vdW50T3V0cHV0KS5nZXRBbW91bnQoKSk7XG4gICAgY29uc3QgaW4xOiBUcmFuc2ZlcmFibGVJbnB1dCA9IG5ldyBUcmFuc2ZlcmFibGVJbnB1dCh1dHhvc1swXS5nZXRUeElEKCksIHV0eG9zWzBdLmdldE91dHB1dElkeCgpLCB1dHhvc1swXS5nZXRBc3NldElEKCksIGlucHQxKTtcblxuICAgIGNvbnN0IGlucHQyOiBTRUNQVHJhbnNmZXJJbnB1dCA9IG5ldyBTRUNQVHJhbnNmZXJJbnB1dCgodXR4b3NbMV0uZ2V0T3V0cHV0KCkgYXMgQW1vdW50T3V0cHV0KS5nZXRBbW91bnQoKSk7XG4gICAgY29uc3QgaW4yOiBUcmFuc2ZlcmFibGVJbnB1dCA9IG5ldyBUcmFuc2ZlcmFibGVJbnB1dCh1dHhvc1sxXS5nZXRUeElEKCksIHV0eG9zWzFdLmdldE91dHB1dElkeCgpLCB1dHhvc1sxXS5nZXRBc3NldElEKCksIGlucHQyKTtcblxuICAgIGNvbnN0IGlucHQzOiBTRUNQVHJhbnNmZXJJbnB1dCA9IG5ldyBTRUNQVHJhbnNmZXJJbnB1dCgodXR4b3NbMl0uZ2V0T3V0cHV0KCkgYXMgQW1vdW50T3V0cHV0KS5nZXRBbW91bnQoKSk7XG4gICAgY29uc3QgaW4zOiBUcmFuc2ZlcmFibGVJbnB1dCA9IG5ldyBUcmFuc2ZlcmFibGVJbnB1dCh1dHhvc1syXS5nZXRUeElEKCksIHV0eG9zWzJdLmdldE91dHB1dElkeCgpLCB1dHhvc1syXS5nZXRBc3NldElEKCksIGlucHQzKTtcblxuICAgIGNvbnN0IGNtcCA9IFRyYW5zZmVyYWJsZUlucHV0LmNvbXBhcmF0b3IoKTtcbiAgICBleHBlY3QoY21wKGluMSwgaW4yKSkudG9CZSgtMSk7XG4gICAgZXhwZWN0KGNtcChpbjEsIGluMykpLnRvQmUoLTEpO1xuICAgIGV4cGVjdChjbXAoaW4xLCBpbjEpKS50b0JlKDApO1xuICAgIGV4cGVjdChjbXAoaW4yLCBpbjIpKS50b0JlKDApO1xuICAgIGV4cGVjdChjbXAoaW4zLCBpbjMpKS50b0JlKDApO1xuICB9KTtcblxuICB0ZXN0KCdFVk1JbnB1dCBjb21wYXJhdG9yJywgKCkgPT4ge1xuICAgIGxldCBpbnB1dHM6IEVWTUlucHV0W10gPSBbXTtcbiAgICBjb25zdCBhZGRyZXNzMTogc3RyaW5nID0gXCIweDU1ZWUwNWRGNzE4ZjFhNUMxNDQxZTc2MTkwRUIxYTE5ZUUyQzk0MzBcIjtcbiAgICBjb25zdCBhZGRyZXNzMzogc3RyaW5nID0gXCIweDk2MzJhNzk2NTZhZjU1M0Y1ODczOEIwRkI3NTAzMjAxNTg0OTU5NDJcIjtcbiAgICBjb25zdCBhZGRyZXNzNDogc3RyaW5nID0gXCIweDRDZjJlRDM2NjVGNmJGQTk1Y0U2QTExQ0ZEYjdBMkVGNUZDMUM3RTRcIjtcbiAgICBjb25zdCBhZGRyZXNzNjogc3RyaW5nID0gXCIweDNDN2RhRTM5NEJCZjhlOUVFMTM1OWFkMTRDMUM0NzAwM2JEMDYyOTNcIjtcbiAgICBjb25zdCBhZGRyZXNzODogc3RyaW5nID0gXCIweDBGYThFQTUzNkJlODVGMzI3MjRENTdBMzc3NTg3NjFCODY0MTYxMjNcIjtcbiAgICBjb25zdCBhbW91bnQxOiBudW1iZXIgPSAxO1xuICAgIGNvbnN0IGFtb3VudDI6IG51bWJlciA9IDI7XG4gICAgY29uc3QgYW1vdW50MzogbnVtYmVyID0gMztcbiAgICBjb25zdCBhbW91bnQ0OiBudW1iZXIgPSA0O1xuICAgIGNvbnN0IGFtb3VudDU6IG51bWJlciA9IDU7XG4gICAgY29uc3QgYW1vdW50NjogbnVtYmVyID0gNjtcbiAgICBjb25zdCBhbW91bnQ3OiBudW1iZXIgPSA3O1xuICAgIGNvbnN0IGFtb3VudDg6IG51bWJlciA9IDg7XG4gICAgY29uc3QgYXNzZXRJRDE6IHN0cmluZyA9IFwiMmZvbWJoTDdhR1B3ajNLSDRiZnJtSndXNlBWbk1vYmY5WTJmbjlHd3hpQUFKeUZEYmVcIjsgLy8gZGJjZjg5MGY3N2Y0OWI5Njg1NzY0OGI3MmI3N2Y5ZjgyOTM3ZjI4YTY4NzA0YWYwNWRhMGRjMTJiYTUzZjJkYlxuICAgIGNvbnN0IGFzc2V0SUQyOiBzdHJpbmcgPSBcInZ2S0NqcnBnZ3lROEZoSjJENUVBS1BoOHg4eTRKSzkzSlFpV1JwVEtwRW91eWRSYkdcIjsgLy8gN2E2ZTFlM2M5YzY2ZWQ4ZjA3NjE4MGY4OWQwMTMyMDc5NTYyOGRjYTYzMzAwMWZmNDM3YWM2YWI1OGI0NTViZVxuICAgIGNvbnN0IGFzc2V0SUQzOiBzdHJpbmcgPSBcImVSbzFlYjJZeGQ4N0t1TVlBTkJTaGEzbjEzOHd0cVJoRnoyeGpmdHNYV25tcEN4eWhcIjsgLy8gNTRmYmQwODdhOGE5YzczOWMyYzc5MjZkNzQyZWE3YjkzN2FkYmQ1MTJiOWZmMGZkNTFmNDYwYTc2M2QxMzcxYVxuICAgIGNvbnN0IGFzc2V0SUQ1OiBzdHJpbmcgPSBcIjJRcVVUVDNYVGdSNkhMYkNMR3RqTjJ1REhIcU5SYUJndEJHSjVLQ3FXN0JVYUgxUDhYXCI7IC8vIGI5ZDE2ZDdjN2QyNjc0YzNjNjdjNWMyNmQ5ZDZlMzlhMDlhNTk5MWM1ODhjZGY2MGM0Y2NhNzMyYjY2ZmE3NDlcbiAgICBjb25zdCBhc3NldElENjogc3RyaW5nID0gXCJaV1hhTGNBeTFZV1MzVnZqY3J0MktjVkE0VnhCc01GdDh5TkRaQUJKa2dCdmdwUnRpXCI7IC8vIDQ5ZDBkYzY3ODQ2YTIwZGZlYTc5YjdiZWViYTg0NzY5ZWZhNGEwMjczNTc1ZjY1Y2E3OWY5ZGVlMWNkMTI1MGVcbiAgICBjb25zdCBhc3NldElENzogc3RyaW5nID0gXCJGSGZTNjFOZkY1WGRaVTYyYmNYcDl5UmZnclplaVFDN1ZOSldLY3BkYjlRTUxIczRMXCI7IC8vIDIwNzBlNzdlMzQ5NDE0MzlkYzdiY2Y1MDJkY2Y1NTVjNmVmMGUzY2M0NmJiYWM4YTAzYjIyZTE1Yzg0YTgxZjFcbiAgICBjb25zdCBhc3NldElEODogc3RyaW5nID0gXCJaTDZOZVdnY254UjJ6aGhLRHg3aDlLZzJtWmdTY0M1TjRSRzVGQ0RheVdZN1czd2haXCI7IC8vIDQ5Njg0OTIzOWJiMTU0MWU5N2ZhOGY4OTI1Njk2NWJmN2U2NTdmM2JiNTMwY2FkODIwZGQ0MTcwNmM1ZTM4MzZcbiAgICBjb25zdCBub25jZTE6IG51bWJlciA9IDA7XG4gICAgY29uc3Qgbm9uY2UyOiBudW1iZXIgPSAxO1xuICAgIGNvbnN0IG5vbmNlMzogbnVtYmVyID0gMjtcbiAgICBjb25zdCBub25jZTQ6IG51bWJlciA9IDM7XG4gICAgY29uc3Qgbm9uY2U1OiBudW1iZXIgPSA0O1xuICAgIGNvbnN0IG5vbmNlNjogbnVtYmVyID0gNTtcbiAgICBjb25zdCBub25jZTc6IG51bWJlciA9IDY7XG4gICAgY29uc3Qgbm9uY2U4OiBudW1iZXIgPSA3O1xuXG4gICAgY29uc3QgaW5wdXQxOiBFVk1JbnB1dCA9IG5ldyBFVk1JbnB1dChhZGRyZXNzMSwgYW1vdW50MSwgYXNzZXRJRDEsIG5vbmNlMSk7XG4gICAgaW5wdXRzLnB1c2goaW5wdXQxKTtcbiAgICBjb25zdCBpbnB1dDI6IEVWTUlucHV0ID0gbmV3IEVWTUlucHV0KGFkZHJlc3MxLCBhbW91bnQyLCBhc3NldElEMiwgbm9uY2UyKTtcbiAgICBpbnB1dHMucHVzaChpbnB1dDIpO1xuICAgIGNvbnN0IGlucHV0MzogRVZNSW5wdXQgPSBuZXcgRVZNSW5wdXQoYWRkcmVzczMsIGFtb3VudDMsIGFzc2V0SUQyLCBub25jZTMpO1xuICAgIGlucHV0cy5wdXNoKGlucHV0Myk7XG4gICAgY29uc3QgaW5wdXQ0OiBFVk1JbnB1dCA9IG5ldyBFVk1JbnB1dChhZGRyZXNzNCwgYW1vdW50NCwgYXNzZXRJRDMsIG5vbmNlNCk7XG4gICAgaW5wdXRzLnB1c2goaW5wdXQ0KTtcbiAgICBjb25zdCBpbnB1dDU6IEVWTUlucHV0ID0gbmV3IEVWTUlucHV0KGFkZHJlc3MxLCBhbW91bnQ1LCBhc3NldElENSwgbm9uY2U1KTtcbiAgICBpbnB1dHMucHVzaChpbnB1dDUpO1xuICAgIGNvbnN0IGlucHV0NjogRVZNSW5wdXQgPSBuZXcgRVZNSW5wdXQoYWRkcmVzczYsIGFtb3VudDYsIGFzc2V0SUQ2LCBub25jZTYpO1xuICAgIGlucHV0cy5wdXNoKGlucHV0Nik7XG4gICAgY29uc3QgaW5wdXQ3OiBFVk1JbnB1dCA9IG5ldyBFVk1JbnB1dChhZGRyZXNzMSwgYW1vdW50NywgYXNzZXRJRDcsIG5vbmNlNyk7XG4gICAgaW5wdXRzLnB1c2goaW5wdXQ3KTtcbiAgICBjb25zdCBpbnB1dDg6IEVWTUlucHV0ID0gbmV3IEVWTUlucHV0KGFkZHJlc3M4LCBhbW91bnQ4LCBhc3NldElEOCwgbm9uY2U4KTtcbiAgICBpbnB1dHMucHVzaChpbnB1dDgpO1xuICAgIGlucHV0cyA9IGlucHV0cy5zb3J0KEVWTUlucHV0LmNvbXBhcmF0b3IoKSlcbiAgICBleHBlY3QoaW5wdXRzWzBdLmdldEFtb3VudCgpLnRvU3RyaW5nKCkpLnRvQmUoXCI4XCIpO1xuICAgIGV4cGVjdChpbnB1dHNbMV0uZ2V0QW1vdW50KCkudG9TdHJpbmcoKSkudG9CZShcIjZcIik7XG4gICAgZXhwZWN0KGlucHV0c1syXS5nZXRBbW91bnQoKS50b1N0cmluZygpKS50b0JlKFwiNFwiKTtcbiAgICBleHBlY3QoaW5wdXRzWzNdLmdldEFtb3VudCgpLnRvU3RyaW5nKCkpLnRvQmUoXCI3XCIpO1xuICAgIGV4cGVjdChpbnB1dHNbNF0uZ2V0QW1vdW50KCkudG9TdHJpbmcoKSkudG9CZShcIjJcIik7XG4gICAgZXhwZWN0KGlucHV0c1s1XS5nZXRBbW91bnQoKS50b1N0cmluZygpKS50b0JlKFwiNVwiKTtcbiAgICBleHBlY3QoaW5wdXRzWzZdLmdldEFtb3VudCgpLnRvU3RyaW5nKCkpLnRvQmUoXCIxXCIpO1xuICAgIGV4cGVjdChpbnB1dHNbN10uZ2V0QW1vdW50KCkudG9TdHJpbmcoKSkudG9CZShcIjNcIik7XG5cbiAgICBjb25zdCBjbXAgPSBFVk1JbnB1dC5jb21wYXJhdG9yKCk7XG4gICAgZXhwZWN0KGNtcChpbnB1dDIsIGlucHV0MSkpLnRvQmUoLTEpO1xuICAgIGV4cGVjdChjbXAoaW5wdXQxLCBpbnB1dDMpKS50b0JlKC0xKTtcbiAgICBleHBlY3QoY21wKGlucHV0MiwgaW5wdXQzKSkudG9CZSgtMSk7XG4gICAgZXhwZWN0KGNtcChpbnB1dDEsIGlucHV0MSkpLnRvQmUoMCk7XG4gICAgZXhwZWN0KGNtcChpbnB1dDIsIGlucHV0MikpLnRvQmUoMCk7XG4gICAgZXhwZWN0KGNtcChpbnB1dDMsIGlucHV0MykpLnRvQmUoMCk7XG4gICAgZXhwZWN0KGNtcChpbnB1dDEsIGlucHV0MikpLnRvQmUoMSk7XG4gICAgZXhwZWN0KGNtcChpbnB1dDMsIGlucHV0MSkpLnRvQmUoMSk7XG4gICAgZXhwZWN0KGNtcChpbnB1dDMsIGlucHV0MikpLnRvQmUoMSk7XG4gIH0pO1xufSk7XG4iXX0=